{"version":3,"sources":["assets/js/editor.js","assets/js/graphics.js","assets/js/gui.js","assets/js/notie.js","assets/js/shell.js","assets/js/zzz_init.js"],"names":["makeEditor","that","window","ace","edit","loadScript","async","url","URL","location","href","script_key","from_key","searchParams","has","script","get","pako","inflate","Base64","toUint8Array","to","decodeURIComponent","setContent","fileURL","Basthon","xhr","method","message","name","localStorage","py_src","scrollToRow","gotoLine","init","session","setMode","focus","setOptions","enableLiveAutocompletion","enableBasicAutocompletion","highlightActiveLine","highlightSelectedWord","fontSize","localCompleter","completers","getCompletions","editor","pos","prefix","callback","locals","_","completions","lines","getValue","split","slice","row","length","column","src","join","complete","c","start","basthon_prefix","map","Set","value","add","caption","download","filename","code","replace","blob","Blob","type","anchor","document","createElement","createObjectURL","target","style","display","body","appendChild","click","removeChild","content","setValue","open","file","Promise","resolve","reject","reader","FileReader","readAsText","onload","event","result","onerror","sharingURL","hash","delete","fromUint8Array","deflate","encodeURIComponent","set","backup","makeGraphics","getElementById","addEventListener","data","clean","textContent","display_type","autoFit","node","width","height","maxWidth","maxHeight","root","justifyContent","alignItems","observer","MutationObserver","mutationsList","mutation","addedNodes","includes","tagName","toLowerCase","observe","childList","querySelectorAll","forEach","canvas","querySelector","setTimeout","innerHTML","outerHTML","console","log","getElementsByTagName","MathJax","typeset","mime","error","makeGUI","notifyError","_console_error","reason","notie","alert","text","stay","time","position","Goodies","hideLoader","e","String","arguments","initStateFromStorage","updateSwitchView","updateDarkLight","button","runScript","openFile","share","restart","showShell","showGraph","switchDarkLight","switchView","hideConsole","hideEditor","showEditorConsole","basthonInit","initCaller","func","catchError","setLoaderText","showLoader","shell","graphics","loadURLAux","loadURLModules","onbeforeunload","catch","_loadFromURL","key","put","promises","getAll","pop","promise","responseType","then","push","all","putFile","bind","putModule","state","_default","getItem","saveStateInStorage","setItem","launch","clear","putFSRessource","readAsArrayBuffer","putRessource","openEditor","openPythonFile","confirm","submitText","cancelText","submitCallback","cancelCallback","input","onchange","files","elt","div_left","div_right","switched","cssFloat","elements","getElementsByClassName","darkmode","classList","theme","setTheme","copyToClipboard","textArea","top","left","padding","border","outline","boxShadow","background","select","msg","execCommand","err","factory","exports","module","define","amd","this","installedModules","__webpack_require__","m","modules","Object","defineProperty","_typeof","Symbol","iterator","obj","constructor","prototype","_extends","assign","i","source","hasOwnProperty","call","tick","wait","blur","activeElement","generateRandomId","r","Math","random","toString","getTransition","options","transitionSelector","transitionDuration","transitionCurve","enterClicked","keyCode","escapeClicked","addToDocument","element","classes","container","offsetHeight","listener","transition","removeFromDocument","id","removeEventListener","parentNode","addOverlayToDocument","owner","ids","overlay","backgroundOverlay","opacity","overlayClickDismiss","onclick","removeOverlayFromDocument","overlayOpacity","_ref4","submitCallbackArg","cancelCallbackArg","undefined","_ref4$submitText","_ref4$cancelText","_ref4$position","positions","settings","keys","indexOf","_objectWithoutProperties","hideAlerts","elementText","textbox","backgroundInfo","textboxInner","elementInput","inputField","setAttribute","autocapitalize","autocomplete","autocorrect","autofocus","inputmode","max","maxlength","min","minlength","placeholder","spellcheck","step","allowed","oninput","regex","Array","isArray","regexString","RegExp","elementButtonLeft","elementHalf","backgroundSuccess","elementButtonRight","backgroundError","alertTime","dateMonths","elementThird","backgroundWarning","backgroundNeutral","selectChoiceRepeated","dateSelectorInner","dateSelectorUp","force","date","newOptions","typeToClassLookup","1","success","2","warning","3","4","info","5","neutral","alertsShowing","_alert","_ref","_ref$type","_ref$time","_ref$stay","_ref$position","_ref2","callbackArg","_ref2$type","_ref2$buttonText","buttonText","_ref2$position","elementButton","_ref3","_ref3$submitText","_ref3$cancelText","_ref3$position","_ref5","_ref5$cancelText","choices","_ref5$position","_ref6","index","_ref6$type","handler","elementChoice","selectChoice","nextChoice","elementCancel","_ref7","_ref7$value","Date","_ref7$submitText","_ref7$cancelText","_ref7$position","setValueHTML","elementDateMonth","getMonth","elementDateDay","getDate","elementDateYear","getFullYear","updateMonth","amount","daysInNextMonth","setDate","setMonth","updateDay","updateYear","setFullYear","arrow","handleBlur","elementDateSelector","elementDateSelectorInner","elementDateUpMonth","elementDateUpDay","elementDateUpYear","daysInMonth","day","Number","year","elementDateDownMonth","elementDateDownDay","elementDateDownYear","default","d","getter","o","configurable","enumerable","n","__esModule","object","property","p","s","moduleId","l","makeShell","ps1","ps2","banner","buffer","reset_buffer","term","$","terminal","command","more","set_prompt","greetings","prompt","completionEscape","completion","resize","interactive","echo","wakeup","stream","_prompt_tail","get_prompt","startsWith","pause","resume","showScript","output","lastChild","header","firstChild","children","backgroundColor","hideShow","converter","none","","block","childNodes","dispatchEvent","gui"],"mappings":"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","file":"main.min.js","sourcesContent":["\"use strict\";\n\nfunction makeEditor() {\n    let that = window.ace.edit(\"editor\");\n    \n    /**\n     * Initialize the editor's content.\n     */\n    that.loadScript = async function () {\n        /* set script from:\n           -> query string if submited\n           -> local storage if available\n           -> default otherwise\n        */\n        const url = new URL(window.location.href);\n        const script_key = 'script';\n        const from_key = 'from';\n        if( url.searchParams.has(script_key) ) {\n            let script = url.searchParams.get(script_key);\n            try {\n                script = pako.inflate(Base64.toUint8Array(script),\n                                      { to: 'string' });\n            } catch {\n                /* backward compatibility with non compressed param */\n                script = decodeURIComponent(script);\n            }\n            that.setContent(script);\n        } else if( url.searchParams.has(from_key) ) {\n            let fileURL = url.searchParams.get(from_key);\n            fileURL = decodeURIComponent(fileURL);\n            let script;\n            try {\n                script = await Basthon.xhr({url: fileURL,\n                                            method: 'GET'});\n            } catch {\n                throw {message: \"Le chargement du script \" + fileURL\n                       + \" a échoué.\",\n                       name: 'LoadingException'};\n            }\n            if( script ) {\n                that.setContent(script);\n            }\n        } else if( (typeof(localStorage) !== \"undefined\") && \"py_src\" in localStorage) {\n            that.setContent(localStorage.py_src);\n        } else {\n            that.setContent('for i in range(10):\\n\\tprint(i)');\n        }\n        \n        that.scrollToRow(0);\n        that.gotoLine(0);\n    };\n\n    /**\n     * Initialize the Ace editor.\n     */\n    that.init = async function () {\n        that.session.setMode(\"ace/mode/python\");\n        that.focus();\n        \n        that.setOptions({\n            'enableLiveAutocompletion': true,\n            'enableBasicAutocompletion': true,\n            'highlightActiveLine': false,\n            'highlightSelectedWord': true,\n            'fontSize': '12pt',\n        });\n\n        // editor's completion\n\n        // removing all completers and keeping track of local completer\n        const localCompleter =  that.completers[1];  // any hint to detect this dynamically?\n        that.completers = [{\n            getCompletions: function(editor, session, pos, prefix, callback) {\n                // get local completions (from editor, not namespace)\n                let locals = [];\n                localCompleter.getCompletions(editor, session, pos, prefix, function (_, completions) { locals = completions; });\n                // recover editor content up to position\n                let lines = editor.getValue().split(\"\\n\");\n                lines = lines.slice(0, pos.row + 1);\n                lines[lines.length - 1] = lines[lines.length - 1].slice(0, pos.column);\n                const src = lines.join(\"\\n\");\n                // Basthon completion\n                let completions = Basthon.complete(src);\n                if( !completions.length ) return;\n                const start = completions[1];\n                completions = completions[0];\n                // removing prefix\n                const basthon_prefix = src.slice(start, -prefix.length);\n                completions = completions.map(c => c.slice(basthon_prefix.length));\n                // union with local completions\n                completions = new Set(completions);\n                for( let c of locals ) {\n                    c = c.value;\n                    if( !(completions.has(c) || completions.has(c + \"(\")) )\n                        completions.add(c);\n                }\n\n                // rendering\n                callback(null, [...completions].map(function (c) { return {\n                    caption: c,\n                    value: c,\n                    //meta: \"code\"\n                }}));\n            }\n        }];\n        \n        await that.loadScript();\n    };\n\n    /**\n     * Downloading editor content as filename.\n     */\n    that.download = function (filename=\"script.py\") {\n        let code = that.getValue();\n        code = code.replace(/\\r\\n|\\r|\\n/g, \"\\r\\n\"); // To retain the Line breaks.\n        let blob = new Blob([code], { type: \"text/plain\" });\n        let anchor = document.createElement(\"a\");\n        anchor.download = filename;\n        anchor.href = window.URL.createObjectURL(blob);\n        anchor.target = \"_blank\";\n        anchor.style.display = \"none\"; // just to be safe!\n        document.body.appendChild(anchor);\n        anchor.click();\n        document.body.removeChild(anchor);\n    };\n\n    /**\n     * Set editor content (undo selection).\n     */\n    that.setContent = function (content) {\n        that.setValue(content);\n        that.scrollToRow(0);\n        that.gotoLine(0);\n    };\n\n    /**\n     * Opening file (async) and loading it in the editor.\n     */\n    that.open = function (file) {\n        return new Promise(function (resolve, reject) {\n            const reader = new FileReader();\n            reader.readAsText(file);\n            reader.onload = function (event) {\n                that.setContent(event.target.result);\n                resolve();\n            };\n            reader.onerror = reject;\n        });\n    };\n\n    /**\n     * Returning the sharing link for the code in the editor.\n     */\n    that.sharingURL = function() {\n        // to retain the Line breaks.\n        const code = that.getValue().replace(/\\r\\n|\\r|\\n/g, \"\\r\\n\");\n        const url = new URL(window.location.href);\n        url.hash = \"\";\n        url.searchParams.delete(\"from\"); // take care of collapsing params\n        let script;\n        try {\n            script = Base64.fromUint8Array(pako.deflate(code), true);\n        } catch { // fallback\n            script = encodeURIComponent(code).replace(/\\(/g, '%28').replace(/\\)/g, '%29');\n        }\n        url.searchParams.set('script', script);\n        return url.href;\n    };\n\n    /**\n     * Backup to local storage.\n     */\n    that.backup = async function() {\n        if (typeof(localStorage) !== \"undefined\") {\n            localStorage.py_src = that.getValue();\n        }\n    };\n    \n    return that;\n}\n","\"use strict\";\n\nfunction makeGraphics() {\n    let that = document.getElementById(\"graphics\");\n\n    /**\n     * Initialize the graphics output.\n     */\n    that.init = async function () {\n        Basthon.addEventListener(\"eval.display\", function (data) {\n            that.display(data);\n        });\n    };\n\n    /**\n     * Cleaning graphics.\n     */\n    that.clean = function() {\n        // textContent seems faster than innerHTML...\n        that.textContent = \"\";\n    };\n\n    /**\n     * Display an element from Basthon data.\n     */\n    that.display = function (data) {\n        that.clean();\n        switch(data.display_type) {\n        case \"p5\":\n            var root = data.content;\n            root.style.width = \"100%\";\n            root.style.height = \"100%\";\n            root.style.display = \"flex\";\n            root.style.justifyContent = \"center\";\n            root.style.alignItems = \"center\";\n            \n            function autoFit(node) {\n                node.style.width = \"auto\";\n                node.style.height = \"auto\";\n                node.style.maxWidth = \"100%\";\n                node.style.maxHeight = \"100%\";\n            }\n\n            // some canvas nodes can be added later so we observe...\n            const observer = new MutationObserver(\n                function(mutationsList, observer) {\n                    for(const mutation of mutationsList)\n                        for( const node of mutation.addedNodes )\n                            if( [\"canvas\", \"video\"].includes(\n                                node.tagName.toLowerCase()) )\n                                autoFit(node);\n                });\n            observer.observe(root, { childList: true });\n            \n            root.querySelectorAll('canvas,video').forEach(autoFit);\n\n            that.appendChild(root);\n            break;\n        case \"matplotlib\":\n            var root = data.content;\n            const canvas = root.querySelector('canvas');\n            if( canvas ) root = canvas;\n            root.style.width = \"\";\n            root.style.height = \"\";\n            root.style.maxWidth = \"100%\";\n            root.style.maxHeight = \"100%\";\n            that.appendChild(root);\n            break;\n        case \"turtle\":\n            // Turtle result\n            window.setTimeout(function () {\n                that.innerHTML = data.content.outerHTML;\n            }, 1);\n            break;\n        case \"sympy\":\n            that.innerHTML = data.content;\n            if( typeof(MathJax) === \"undefined\" ) {\n                // dynamically loading MathJax\n                console.log(\"Loading MathJax (Sympy expression needs it).\");\n                (function () {\n                    let script = document.createElement(\"script\");\n                    script.type = \"text/javascript\";\n                    script.src  = \"https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js\";\n                    document.getElementsByTagName(\"head\")[0].appendChild(script);\n                })();\n            } else {\n                // otherwise, render it\n                MathJax.typeset();\n            }\n            break;\n        case \"html\":\n            that.innerHTML = data.content;\n            break;\n        case \"multiple\":\n            /* typically dispached by display() */\n            for( let mime of ['image/svg+xml',\n                              'image/png',\n                              'text/html',\n                              'text/plain'] ) {\n                if( mime in data.content ) {\n                    let content = data.content[mime];\n                    if( mime === 'image/png' ) {\n                        content = '<img src=\"data:image/png;base64,' + content + '\" style=\"max-width: 100%; max-height: 100%;\">';\n                    }\n                    that.innerHTML = content;\n                    break;\n                }\n            }\n            break;\n        default:\n            console.error(\"Not supported node type in eval.display result processing.\");\n        }\n    };\n\n    return that;\n}\n","\"use strict\";\n\nfunction makeGUI() {\n    let that = {};\n\n    /**\n     * The error notification system.\n     */\n    that.notifyError = function (error) {\n        that._console_error(error);\n        const message = error.message || error.reason.message || error;\n        notie.alert({\n            type: 'error',\n            text: 'Erreur : ' + message,\n            stay: false,\n            time: 3,\n            position: 'top',\n        });\n        // In case of error, force loader hiding.\n        try {\n            Basthon.Goodies.hideLoader();\n        } catch (e) {}\n    };\n\n    /**\n     * Initialize the GUI.\n     */\n    that.init = async function() {\n        /* all errors redirected to notification system */\n        const onerror = that.notifyError;\n        window.addEventListener('error', onerror);\n        window.addEventListener(\"unhandledrejection\", onerror);\n        /* console errors redirected to notification system */\n        that._console_error = console.error;\n        console.error = function() {\n            onerror({message: String(arguments[0])});\n        };\n        \n        /* state variables */\n        that.initStateFromStorage('switched', false);\n        that.initStateFromStorage('darkmode', true);\n\n        /* update appearance from state variables */\n        that.updateSwitchView();\n        that.updateDarkLight();\n        \n        /* connecting buttons */\n        // run\n        let button = document.getElementById('run');\n        button.addEventListener('click', that.runScript);\n        // open\n        button = document.getElementById(\"open\");\n        button.addEventListener(\"click\", that.openFile);\n        // download\n        button = document.getElementById(\"download\");\n        button.addEventListener(\"click\", that.download);\n        // share\n        button = document.getElementById(\"share\");\n        button.addEventListener(\"click\", that.share);\n        \n        // raz\n        button = document.getElementById('raz');\n        button.addEventListener('click', that.restart);\n        // show shell\n        button = document.getElementById(\"btn_shell\");\n        button.addEventListener(\"click\", that.showShell);\n        // show graph\n        button = document.getElementById(\"btn_graph_view\");\n        button.addEventListener(\"click\", that.showGraph);\n        // dark/light mode\n        button = document.getElementById(\"darklight\");\n        button.addEventListener(\"click\", that.switchDarkLight);\n        // view switch\n        button = document.getElementById(\"switch\");\n        button.addEventListener(\"click\", that.switchView);\n        // single/double vew\n        button = document.getElementById(\"hide-console\");\n        button.addEventListener(\"click\", that.hideConsole);\n        button = document.getElementById(\"hide-editor\");\n        button.addEventListener(\"click\", that.hideEditor);\n        button = document.getElementById(\"show-editor-console\");\n        button.addEventListener(\"click\", that.showEditorConsole);\n\n        // initialise Basthon\n        await that.basthonInit();\n    };\n\n    /**\n     * Change loader text and call init function.\n     * If catchError is false, in case of error, we continue the\n     * init process, trying to do our best...\n     */\n    that.initCaller = async function (func, message, catchError) {\n        Basthon.Goodies.setLoaderText(message);\n        try {\n            return await func();\n        } catch (error) {\n            if( !catchError ) throw error;\n            that.notifyError(error);\n        }\n    };\n\n    /**\n     * Loading Basthon and connecting to events.\n     */\n    that.basthonInit = async function () {\n        // loading Basthon (errors are fatal)\n        await Basthon.Goodies.showLoader(\"Chargement de Basthon...\", false);\n        const init = that.initCaller;\n        // loading shell\n        await init(shell.init, \"Chargement de la console...\", true);\n        // loading editor\n        await init(editor.init, \"Chargement de l'éditeur...\", true);\n        // loading graphics\n        await init(graphics.init, \"Chargement de la sortie graphique...\", true);\n        // loading aux files from URL\n        await init(that.loadURLAux, \"Chargement des fichiers auxiliaires...\", true);\n        // loading modules from URL\n        await init(that.loadURLModules, \"Chargement des modules annexes...\", true);\n        // end\n        Basthon.Goodies.hideLoader();\n\n        /* backup before closing */\n        window.onbeforeunload = function () {\n            editor.backup().catch(that.notifyError);\n        };\n    };\n\n    /**\n     * Load ressources from URL (common part to files and modules).\n     */\n    that._loadFromURL = async function (key, put) {\n        const url = new URL(window.location.href);\n        let promises = [];\n        for( let fileURL of url.searchParams.getAll(key) ) {\n            fileURL = decodeURIComponent(fileURL);\n            const filename = fileURL.split('/').pop();\n            let promise = Basthon.xhr({method: \"GET\",\n                                       url: fileURL,\n                                       responseType: \"arraybuffer\"});\n            promise = promise.then(function (data) {\n                return put(filename, data);\n            }).catch(function () {\n                throw {message: \"Impossible de charger le fichier \" + filename + \".\",\n                      name: \"LoadingException\"};\n            });\n            promises.push(promise);\n        }\n        await Promise.all(promises);\n    };\n\n    /**\n     * Load auxiliary files submited via URL (aux= parameter) (async).\n     */\n    that.loadURLAux = function () {\n        return that._loadFromURL('aux', Basthon.putFile.bind(Basthon));\n    };\n\n    /**\n     * Load modules submited via URL (module= parameter) (async).\n     */\n    that.loadURLModules = function () {\n        return that._loadFromURL('module', Basthon.putModule.bind(Basthon));\n    };\n\n    /**\n     * Init a state variable from local storage (with default value).\n     */\n    that.initStateFromStorage = function(state, _default=false) {\n        if( typeof(Storage) !== \"undefined\"\n            && localStorage.getItem(state) !== null) {\n            that[state] = localStorage.getItem(state) === \"true\";\n        } else {\n            that[state] = _default;\n        }\n    };\n\n    /**\n     * Save a state variable in local storage.\n     */\n    that.saveStateInStorage = function(state) {\n        if (typeof(Storage) !== \"undefined\") {\n            localStorage.setItem(state, that[state]);\n        }\n    };\n    \n    /**\n     * Run the editor script in the shell.\n     */\n    that.runScript = function () {\n        // backup the script just before running\n        editor.backup().catch(that.notifyError);\n        const src = editor.getValue();\n        shell.launch(src, false);\n        shell.focus();\n    };\n    \n    /**\n     * RAZ function.\n     */\n    that.restart = function () {\n        Basthon.restart();\n        shell.clear();\n        graphics.clean();\n    };\n\n    /**\n     * Loading file in the (emulated) local filesystem (async).\n     */\n    that.putFSRessource = function (file) {\n        return new Promise(function (resolve, reject) {\n            const reader = new FileReader();\n            reader.readAsArrayBuffer(file);\n            reader.onload = async function (event) {\n                await Basthon.putRessource(file.name, event.target.result);\n                notie.alert({\n                    type: 'success',\n                    text: file.name + \" est maintenant utilisable depuis Python\",\n                    stay: false,\n                    time: 3,\n                    position: 'top'\n                });\n                resolve();\n            };\n            reader.onerror = reject;\n        });\n    };\n\n    /**\n     * Open file in editor.\n     */\n    that.openEditor = async function (file) {\n        await editor.open(file);\n        notie.alert({\n            type: 'success',\n            text: file.name + \" est chargé dans l'éditeur\",\n            stay: false,\n            time: 3,\n            position: 'top'\n        });\n    };\n\n    /**\n     * Open *.py file by asking user what to do:\n     * load in editor or put on (emulated) local filesystem.\n     */\n    that.openPythonFile = async function (file) {\n        notie.confirm({\n            text: \"Que faire de \" + file.name + \" ?\",\n            submitText: \"Charger dans l'éditeur\",\n            cancelText: \"Installer le module\",\n            position: 'top',\n            submitCallback: () => { that.openEditor(file); },\n            cancelCallback: () => { that.putFSRessource(file); }\n        });\n    };\n\n    /**\n     * Opening file: If it has .py extension, loading it in the editor\n     * or put on (emulated) local filesystem (user is asked to),\n     * otherwise, loading it in the local filesystem.\n     */\n    that.openFile = function () {\n        return new Promise(function (resolve, reject) {\n            let input = document.createElement('input');\n            input.type = 'file';\n            input.style.display = \"none\";\n            input.onchange = async function (event) {\n                for( let file of event.target.files ) {\n                    const ext = file.name.split('.').pop();\n                    if(ext === 'py') {\n                        await that.openPythonFile(file);\n                    } else {\n                        await that.putFSRessource(file);\n                    }\n                }\n                resolve();\n            };\n            input.onerror = reject;\n\n            document.body.appendChild(input);\n            input.click();\n            document.body.removeChild(input);\n        });\n    };\n\n    /**\n     * Download script in editor.\n     */\n    that.download = function () {\n        editor.download(\"script.py\");\n    };\n    \n    /**\n     * Displaying editor alone.\n     */\n    that.hideConsole = function () {\n        let button = document.getElementById(\"hide-console\");\n        button.style.display = \"none\";\n        button = document.getElementById(\"hide-editor\");\n        button.style.display = \"\";\n        let elt = document.getElementById(\"right-div\");\n        elt.style.display = \"none\";\n        elt = document.getElementById(\"left-div\");\n        elt.style.display = \"\";\n        elt.style.width = \"100%\";\n    };\n    \n    /**\n     * Displaying console alone.\n     */\n    that.hideEditor = function () {\n        let button = document.getElementById(\"hide-editor\");\n        button.style.display = \"none\";\n        button = document.getElementById(\"show-editor-console\");\n        button.style.display = \"\";\n        let elt = document.getElementById(\"left-div\");\n        elt.style.display = \"none\";\n        elt = document.getElementById(\"right-div\");\n        elt.style.display = \"\";\n        elt.style.width = \"100%\";\n    };\n    \n    /**\n     * Editor and console side by side.\n     */\n    that.showEditorConsole = function () {\n        let button = document.getElementById(\"show-editor-console\");\n        button.style.display = \"none\";\n        button = document.getElementById(\"hide-console\");\n        button.style.display = \"\";\n        let elt = document.getElementById(\"left-div\");\n        elt.style.display = \"\";\n        elt.style.width = \"50%\";\n        elt = document.getElementById(\"right-div\");\n        elt.style.display = \"\";\n        elt.style.width = \"48%\";\n    };\n    \n    /**\n     * Update switch view.\n     */\n    that.updateSwitchView = function () {\n        let div_left = document.getElementById(\"left-div\");\n        let div_right = document.getElementById(\"right-div\");\n        \n        if(that.switched) {\n            div_left.style.cssFloat = \"right\";\n            div_right.style.cssFloat = \"left\";\n        } else {\n            div_left.style.cssFloat = \"left\";\n            div_right.style.cssFloat = \"right\";\n        }\n    };\n    \n    /**\n     * Switching side view.\n     */\n    that.switchView = function () {\n        that.switched = !that.switched;\n        that.updateSwitchView();\n        that.saveStateInStorage('switched');\n    };\n\n    /**\n     * Update dark/light appearence.\n     */\n    that.updateDarkLight = function () {\n        const elements = document.getElementsByClassName(\"darklighted\");\n        const func = that.darkmode ? 'remove' : 'add';\n        for( const e of elements) e.classList[func](\"light\");\n        const theme = that.darkmode ? \"monokai\" : \"xcode\";\n        editor.setTheme(`ace/theme/${theme}`);\n    };\n\n    /**\n     * Switch dark/light mode.\n     */\n    that.switchDarkLight = function () {\n        that.darkmode = !that.darkmode;\n        that.saveStateInStorage('darkmode');\n        that.updateDarkLight();\n    };\n\n    /**\n     * Get mode as a string (dark/light).\n     */\n    that.theme = function () {\n        return that.darkmode ? \"dark\" : \"light\";\n    };\n    \n    /**\n     * Toggle hide/show shell/graph.\n     */\n    that.showShell = function () {\n        shell.style.display = \"block\";\n        graphics.style.display = \"none\";\n    };\n\n    /**\n     * Toggle hide/show shell/graph.\n     */\n    that.showGraph = function () {\n        shell.style.display = \"none\";\n        graphics.style.display = \"flex\";\n    }; \n    \n    /**\n     * Share script via URL.\n     */\n    that.share = function () {\n        const url = editor.sharingURL();\n        notie.confirm({\n            text: document.getElementById(\"share_message\").innerHTML,\n            submitText: \"Copier dans le presse-papier\",\n            cancelText: \"Tester le lien\",\n            position: 'top',\n            submitCallback: function() { that.copyToClipboard(url); },\n            cancelCallback: function() {\n                let anchor = document.createElement(\"a\");\n                anchor.href = url;\n                anchor.target = \"_blank\";\n                anchor.style.display = \"none\"; // just to be safe!\n                document.body.appendChild(anchor);\n                anchor.click();\n                document.body.removeChild(anchor);\n            }\n        });\n    };\n    \n    /**\n     * Copy a text to clipboard.\n     */\n    that.copyToClipboard = function (text) {\n        let textArea = document.createElement(\"textarea\");\n        \n        // Precautions from https://stackoverflow.com/questions/400212/how-do-i-copy-to-the-clipboard-in-javascript\n        \n        // Place in top-left corner of screen regardless of scroll position.\n        textArea.style.position = 'fixed';\n        textArea.style.top = 0;\n        textArea.style.left = 0;\n        \n        // Ensure it has a small width and height. Setting to 1px / 1em\n        // doesn't work as this gives a negative w/h on some browsers.\n        textArea.style.width = '2em';\n        textArea.style.height = '2em';\n        \n        // We don't need padding, reducing the size if it does flash render.\n        textArea.style.padding = 0;\n        \n        // Clean up any borders.\n        textArea.style.border = 'none';\n        textArea.style.outline = 'none';\n        textArea.style.boxShadow = 'none';\n        \n        // Avoid flash of white box if rendered for any reason.\n        textArea.style.background = 'transparent';\n        \n        \n        textArea.value = text;\n        \n        document.body.appendChild(textArea);\n        textArea.focus();\n        textArea.select();\n        \n        try {\n            let successful = document.execCommand('copy');\n            let msg = successful ? 'successful' : 'unsuccessful';\n            console.log('Copying text command was ' + msg);\n        } catch (err) {\n            console.log('Oops, unable to copy');\n        }\n        \n        document.body.removeChild(textArea);\n    };\n    \n    return that;\n}\n","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"notie\"] = factory();\n\telse\n\t\troot[\"notie\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// identity function for calling harmony imports with the correct context\n/******/ \t__webpack_require__.i = function(value) { return value; };\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nfunction _objectWithoutProperties(obj, keys) { var target = {}; for (var i in obj) { if (keys.indexOf(i) >= 0) continue; if (!Object.prototype.hasOwnProperty.call(obj, i)) continue; target[i] = obj[i]; } return target; }\n\n// ====================\n// options\n// ====================\n\nvar positions = {\n  top: 'top',\n  bottom: 'bottom'\n};\n\nvar options = {\n  alertTime: 3,\n  dateMonths: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'],\n  overlayClickDismiss: true,\n  overlayOpacity: 0.75,\n  transitionCurve: 'ease',\n  transitionDuration: 0.3,\n  transitionSelector: 'all',\n  classes: {\n    container: 'notie-container',\n    textbox: 'notie-textbox',\n    textboxInner: 'notie-textbox-inner',\n    button: 'notie-button',\n    element: 'notie-element',\n    elementHalf: 'notie-element-half',\n    elementThird: 'notie-element-third',\n    overlay: 'notie-overlay',\n    backgroundSuccess: 'notie-background-success',\n    backgroundWarning: 'notie-background-warning',\n    backgroundError: 'notie-background-error',\n    backgroundInfo: 'notie-background-info',\n    backgroundNeutral: 'notie-background-neutral',\n    backgroundOverlay: 'notie-background-overlay',\n    alert: 'notie-alert',\n    inputField: 'notie-input-field',\n    selectChoiceRepeated: 'notie-select-choice-repeated',\n    dateSelectorInner: 'notie-date-selector-inner',\n    dateSelectorUp: 'notie-date-selector-up'\n  },\n  ids: {\n    overlay: 'notie-overlay'\n  },\n  positions: {\n    alert: positions.top,\n    force: positions.top,\n    confirm: positions.top,\n    input: positions.top,\n    select: positions.bottom,\n    date: positions.top\n  }\n};\n\nvar setOptions = exports.setOptions = function setOptions(newOptions) {\n  options = _extends({}, options, newOptions, {\n    classes: _extends({}, options.classes, newOptions.classes),\n    ids: _extends({}, options.ids, newOptions.ids),\n    positions: _extends({}, options.positions, newOptions.positions)\n  });\n};\n\n// ====================\n// helpers\n// ====================\n\nvar tick = function tick() {\n  return new Promise(function (resolve) {\n    return setTimeout(resolve, 0);\n  });\n};\nvar wait = function wait(time) {\n  return new Promise(function (resolve) {\n    return setTimeout(resolve, time * 1000);\n  });\n};\n\nvar blur = function blur() {\n  document.activeElement && document.activeElement.blur();\n};\n\nvar generateRandomId = function generateRandomId() {\n  // RFC4122 version 4 compliant UUID\n  var id = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n    var r = Math.random() * 16 | 0;\n    var v = c === 'x' ? r : r & 0x3 | 0x8;\n    return v.toString(16);\n  });\n  return 'notie-' + id;\n};\n\nvar typeToClassLookup = {\n  1: options.classes.backgroundSuccess,\n  success: options.classes.backgroundSuccess,\n  2: options.classes.backgroundWarning,\n  warning: options.classes.backgroundWarning,\n  3: options.classes.backgroundError,\n  error: options.classes.backgroundError,\n  4: options.classes.backgroundInfo,\n  info: options.classes.backgroundInfo,\n  5: options.classes.backgroundNeutral,\n  neutral: options.classes.backgroundNeutral\n};\n\nvar getTransition = function getTransition() {\n  return options.transitionSelector + ' ' + options.transitionDuration + 's ' + options.transitionCurve;\n};\n\nvar enterClicked = function enterClicked(event) {\n  return event.keyCode === 13;\n};\nvar escapeClicked = function escapeClicked(event) {\n  return event.keyCode === 27;\n};\n\nvar addToDocument = function addToDocument(element, position) {\n  element.classList.add(options.classes.container);\n  element.style[position] = '-10000px';\n  document.body.appendChild(element);\n  element.style[position] = '-' + element.offsetHeight + 'px';\n\n  if (element.listener) window.addEventListener('keydown', element.listener);\n\n  tick().then(function () {\n    element.style.transition = getTransition();\n    element.style[position] = 0;\n  });\n};\n\nvar removeFromDocument = function removeFromDocument(id, position) {\n  var element = document.getElementById(id);\n  if (!element) return;\n  element.style[position] = '-' + element.offsetHeight + 'px';\n\n  if (element.listener) window.removeEventListener('keydown', element.listener);\n\n  wait(options.transitionDuration).then(function () {\n    if (element.parentNode) element.parentNode.removeChild(element);\n  });\n};\n\nvar addOverlayToDocument = function addOverlayToDocument(owner, position) {\n  var element = document.createElement('div');\n  element.id = options.ids.overlay;\n  element.classList.add(options.classes.overlay);\n  element.classList.add(options.classes.backgroundOverlay);\n  element.style.opacity = 0;\n  if (owner && options.overlayClickDismiss) {\n    element.onclick = function () {\n      removeFromDocument(owner.id, position);\n      removeOverlayFromDocument();\n    };\n  }\n\n  document.body.appendChild(element);\n\n  tick().then(function () {\n    element.style.transition = getTransition();\n    element.style.opacity = options.overlayOpacity;\n  });\n};\n\nvar removeOverlayFromDocument = function removeOverlayFromDocument() {\n  var element = document.getElementById(options.ids.overlay);\n  element.style.opacity = 0;\n  wait(options.transitionDuration).then(function () {\n    if (element.parentNode) element.parentNode.removeChild(element);\n  });\n};\n\nvar hideAlerts = exports.hideAlerts = function hideAlerts(callback) {\n  var alertsShowing = document.getElementsByClassName(options.classes.alert);\n  if (alertsShowing.length) {\n    for (var i = 0; i < alertsShowing.length; i++) {\n      var _alert = alertsShowing[i];\n      removeFromDocument(_alert.id, _alert.position);\n    }\n    if (callback) wait(options.transitionDuration).then(function () {\n      return callback();\n    });\n  }\n};\n\n// ====================\n// exports\n// ====================\n\nvar alert = exports.alert = function alert(_ref) {\n  var _ref$type = _ref.type,\n      type = _ref$type === undefined ? 4 : _ref$type,\n      text = _ref.text,\n      _ref$time = _ref.time,\n      time = _ref$time === undefined ? options.alertTime : _ref$time,\n      _ref$stay = _ref.stay,\n      stay = _ref$stay === undefined ? false : _ref$stay,\n      _ref$position = _ref.position,\n      position = _ref$position === undefined ? options.positions.alert || position.top : _ref$position;\n\n  blur();\n  hideAlerts();\n\n  var element = document.createElement('div');\n  var id = generateRandomId();\n  element.id = id;\n  element.position = position;\n  element.classList.add(options.classes.textbox);\n  element.classList.add(typeToClassLookup[type]);\n  element.classList.add(options.classes.alert);\n  element.innerHTML = '<div class=\"' + options.classes.textboxInner + '\">' + text + '</div>';\n  element.onclick = function () {\n    return removeFromDocument(id, position);\n  };\n\n  element.listener = function (event) {\n    if (enterClicked(event) || escapeClicked(event)) hideAlerts();\n  };\n\n  addToDocument(element, position);\n\n  if (time && time < 1) time = 1;\n  if (!stay && time) wait(time).then(function () {\n    return removeFromDocument(id, position);\n  });\n};\n\nvar force = exports.force = function force(_ref2, callbackArg) {\n  var _ref2$type = _ref2.type,\n      type = _ref2$type === undefined ? 5 : _ref2$type,\n      text = _ref2.text,\n      _ref2$buttonText = _ref2.buttonText,\n      buttonText = _ref2$buttonText === undefined ? 'OK' : _ref2$buttonText,\n      callback = _ref2.callback,\n      _ref2$position = _ref2.position,\n      position = _ref2$position === undefined ? options.positions.force || position.top : _ref2$position;\n\n  blur();\n  hideAlerts();\n\n  var element = document.createElement('div');\n  var id = generateRandomId();\n  element.id = id;\n\n  var elementText = document.createElement('div');\n  elementText.classList.add(options.classes.textbox);\n  elementText.classList.add(options.classes.backgroundInfo);\n  elementText.innerHTML = '<div class=\"' + options.classes.textboxInner + '\">' + text + '</div>';\n\n  var elementButton = document.createElement('div');\n  elementButton.classList.add(options.classes.button);\n  elementButton.classList.add(typeToClassLookup[type]);\n  elementButton.innerHTML = buttonText;\n  elementButton.onclick = function () {\n    removeFromDocument(id, position);\n    removeOverlayFromDocument();\n    if (callback) callback();else if (callbackArg) callbackArg();\n  };\n\n  element.appendChild(elementText);\n  element.appendChild(elementButton);\n\n  element.listener = function (event) {\n    if (enterClicked(event)) elementButton.click();\n  };\n\n  addToDocument(element, position);\n\n  addOverlayToDocument();\n};\n\nvar confirm = exports.confirm = function confirm(_ref3, submitCallbackArg, cancelCallbackArg) {\n  var text = _ref3.text,\n      _ref3$submitText = _ref3.submitText,\n      submitText = _ref3$submitText === undefined ? 'Yes' : _ref3$submitText,\n      _ref3$cancelText = _ref3.cancelText,\n      cancelText = _ref3$cancelText === undefined ? 'Cancel' : _ref3$cancelText,\n      submitCallback = _ref3.submitCallback,\n      cancelCallback = _ref3.cancelCallback,\n      _ref3$position = _ref3.position,\n      position = _ref3$position === undefined ? options.positions.confirm || position.top : _ref3$position;\n\n  blur();\n  hideAlerts();\n\n  var element = document.createElement('div');\n  var id = generateRandomId();\n  element.id = id;\n\n  var elementText = document.createElement('div');\n  elementText.classList.add(options.classes.textbox);\n  elementText.classList.add(options.classes.backgroundInfo);\n  elementText.innerHTML = '<div class=\"' + options.classes.textboxInner + '\">' + text + '</div>';\n\n  var elementButtonLeft = document.createElement('div');\n  elementButtonLeft.classList.add(options.classes.button);\n  elementButtonLeft.classList.add(options.classes.elementHalf);\n  elementButtonLeft.classList.add(options.classes.backgroundSuccess);\n  elementButtonLeft.innerHTML = submitText;\n  elementButtonLeft.onclick = function () {\n    removeFromDocument(id, position);\n    removeOverlayFromDocument();\n    if (submitCallback) submitCallback();else if (submitCallbackArg) submitCallbackArg();\n  };\n\n  var elementButtonRight = document.createElement('div');\n  elementButtonRight.classList.add(options.classes.button);\n  elementButtonRight.classList.add(options.classes.elementHalf);\n  elementButtonRight.classList.add(options.classes.backgroundError);\n  elementButtonRight.innerHTML = cancelText;\n  elementButtonRight.onclick = function () {\n    removeFromDocument(id, position);\n    removeOverlayFromDocument();\n    if (cancelCallback) cancelCallback();else if (cancelCallbackArg) cancelCallbackArg();\n  };\n\n  element.appendChild(elementText);\n  element.appendChild(elementButtonLeft);\n  element.appendChild(elementButtonRight);\n\n  element.listener = function (event) {\n    if (enterClicked(event)) elementButtonLeft.click();else if (escapeClicked(event)) elementButtonRight.click();\n  };\n\n  addToDocument(element, position);\n\n  addOverlayToDocument(element, position);\n};\n\nvar input = function input(_ref4, submitCallbackArg, cancelCallbackArg) {\n  var text = _ref4.text,\n      _ref4$submitText = _ref4.submitText,\n      submitText = _ref4$submitText === undefined ? 'Submit' : _ref4$submitText,\n      _ref4$cancelText = _ref4.cancelText,\n      cancelText = _ref4$cancelText === undefined ? 'Cancel' : _ref4$cancelText,\n      submitCallback = _ref4.submitCallback,\n      cancelCallback = _ref4.cancelCallback,\n      _ref4$position = _ref4.position,\n      position = _ref4$position === undefined ? options.positions.input || position.top : _ref4$position,\n      settings = _objectWithoutProperties(_ref4, ['text', 'submitText', 'cancelText', 'submitCallback', 'cancelCallback', 'position']);\n\n  blur();\n  hideAlerts();\n\n  var element = document.createElement('div');\n  var id = generateRandomId();\n  element.id = id;\n\n  var elementText = document.createElement('div');\n  elementText.classList.add(options.classes.textbox);\n  elementText.classList.add(options.classes.backgroundInfo);\n  elementText.innerHTML = '<div class=\"' + options.classes.textboxInner + '\">' + text + '</div>';\n\n  var elementInput = document.createElement('input');\n  elementInput.classList.add(options.classes.inputField);\n\n  elementInput.setAttribute('autocapitalize', settings.autocapitalize || 'none');\n  elementInput.setAttribute('autocomplete', settings.autocomplete || 'off');\n  elementInput.setAttribute('autocorrect', settings.autocorrect || 'off');\n  elementInput.setAttribute('autofocus', settings.autofocus || 'true');\n  elementInput.setAttribute('inputmode', settings.inputmode || 'verbatim');\n  elementInput.setAttribute('max', settings.max || '');\n  elementInput.setAttribute('maxlength', settings.maxlength || '');\n  elementInput.setAttribute('min', settings.min || '');\n  elementInput.setAttribute('minlength', settings.minlength || '');\n  elementInput.setAttribute('placeholder', settings.placeholder || '');\n  elementInput.setAttribute('spellcheck', settings.spellcheck || 'default');\n  elementInput.setAttribute('step', settings.step || 'any');\n  elementInput.setAttribute('type', settings.type || 'text');\n\n  elementInput.value = settings.value || '';\n\n  // As-you-type input restrictions\n  if (settings.allowed) {\n    elementInput.oninput = function () {\n      var regex = void 0;\n      if (Array.isArray(settings.allowed)) {\n        var regexString = '';\n        var allowed = settings.allowed;\n        for (var i = 0; i < allowed.length; i++) {\n          if (allowed[i] === 'an') regexString += '0-9a-zA-Z';else if (allowed[i] === 'a') regexString += 'a-zA-Z';else if (allowed[i] === 'n') regexString += '0-9';\n          if (allowed[i] === 's') regexString += ' ';\n        }\n        regex = new RegExp('[^' + regexString + ']', 'g');\n      } else if (_typeof(settings.allowed) === 'object') {\n        regex = settings.allowed;\n      }\n      elementInput.value = elementInput.value.replace(regex, '');\n    };\n  }\n\n  var elementButtonLeft = document.createElement('div');\n  elementButtonLeft.classList.add(options.classes.button);\n  elementButtonLeft.classList.add(options.classes.elementHalf);\n  elementButtonLeft.classList.add(options.classes.backgroundSuccess);\n  elementButtonLeft.innerHTML = submitText;\n  elementButtonLeft.onclick = function () {\n    removeFromDocument(id, position);\n    removeOverlayFromDocument();\n    if (submitCallback) submitCallback(elementInput.value);else if (submitCallbackArg) submitCallbackArg(elementInput.value);\n  };\n\n  var elementButtonRight = document.createElement('div');\n  elementButtonRight.classList.add(options.classes.button);\n  elementButtonRight.classList.add(options.classes.elementHalf);\n  elementButtonRight.classList.add(options.classes.backgroundError);\n  elementButtonRight.innerHTML = cancelText;\n  elementButtonRight.onclick = function () {\n    removeFromDocument(id, position);\n    removeOverlayFromDocument();\n    if (cancelCallback) cancelCallback(elementInput.value);else if (cancelCallbackArg) cancelCallbackArg(elementInput.value);\n  };\n\n  element.appendChild(elementText);\n  element.appendChild(elementInput);\n  element.appendChild(elementButtonLeft);\n  element.appendChild(elementButtonRight);\n\n  element.listener = function (event) {\n    if (enterClicked(event)) elementButtonLeft.click();else if (escapeClicked(event)) elementButtonRight.click();\n  };\n\n  addToDocument(element, position);\n\n  elementInput.focus();\n\n  addOverlayToDocument(element, position);\n};\n\nexports.input = input;\nvar select = exports.select = function select(_ref5, cancelCallbackArg) {\n  var text = _ref5.text,\n      _ref5$cancelText = _ref5.cancelText,\n      cancelText = _ref5$cancelText === undefined ? 'Cancel' : _ref5$cancelText,\n      cancelCallback = _ref5.cancelCallback,\n      choices = _ref5.choices,\n      _ref5$position = _ref5.position,\n      position = _ref5$position === undefined ? options.positions.select || position.top : _ref5$position;\n\n  blur();\n  hideAlerts();\n\n  var element = document.createElement('div');\n  var id = generateRandomId();\n  element.id = id;\n\n  var elementText = document.createElement('div');\n  elementText.classList.add(options.classes.textbox);\n  elementText.classList.add(options.classes.backgroundInfo);\n  elementText.innerHTML = '<div class=\"' + options.classes.textboxInner + '\">' + text + '</div>';\n\n  element.appendChild(elementText);\n\n  choices.forEach(function (_ref6, index) {\n    var _ref6$type = _ref6.type,\n        type = _ref6$type === undefined ? 1 : _ref6$type,\n        text = _ref6.text,\n        handler = _ref6.handler;\n\n    var elementChoice = document.createElement('div');\n    elementChoice.classList.add(typeToClassLookup[type]);\n    elementChoice.classList.add(options.classes.button);\n    elementChoice.classList.add(options.classes.selectChoice);\n\n    var nextChoice = choices[index + 1];\n    if (nextChoice && !nextChoice.type) nextChoice.type = 1;\n    if (nextChoice && nextChoice.type === type) {\n      elementChoice.classList.add(options.classes.selectChoiceRepeated);\n    }\n\n    elementChoice.innerHTML = text;\n    elementChoice.onclick = function () {\n      removeFromDocument(id, position);\n      removeOverlayFromDocument();\n      handler();\n    };\n\n    element.appendChild(elementChoice);\n  });\n\n  var elementCancel = document.createElement('div');\n  elementCancel.classList.add(options.classes.backgroundNeutral);\n  elementCancel.classList.add(options.classes.button);\n  elementCancel.innerHTML = cancelText;\n  elementCancel.onclick = function () {\n    removeFromDocument(id, position);\n    removeOverlayFromDocument();\n    if (cancelCallback) cancelCallback();else if (cancelCallbackArg) cancelCallbackArg();\n  };\n\n  element.appendChild(elementCancel);\n\n  element.listener = function (event) {\n    if (escapeClicked(event)) elementCancel.click();\n  };\n\n  addToDocument(element, position);\n\n  addOverlayToDocument(element, position);\n};\n\nvar date = exports.date = function date(_ref7, submitCallbackArg, cancelCallbackArg) {\n  var _ref7$value = _ref7.value,\n      value = _ref7$value === undefined ? new Date() : _ref7$value,\n      _ref7$submitText = _ref7.submitText,\n      submitText = _ref7$submitText === undefined ? 'OK' : _ref7$submitText,\n      _ref7$cancelText = _ref7.cancelText,\n      cancelText = _ref7$cancelText === undefined ? 'Cancel' : _ref7$cancelText,\n      submitCallback = _ref7.submitCallback,\n      cancelCallback = _ref7.cancelCallback,\n      _ref7$position = _ref7.position,\n      position = _ref7$position === undefined ? options.positions.date || position.top : _ref7$position;\n\n  blur();\n  hideAlerts();\n\n  var arrow = '&#9662';\n\n  var elementDateMonth = document.createElement('div');\n  var elementDateDay = document.createElement('div');\n  var elementDateYear = document.createElement('div');\n\n  var setValueHTML = function setValueHTML(date) {\n    elementDateMonth.innerHTML = options.dateMonths[date.getMonth()];\n    elementDateDay.innerHTML = date.getDate();\n    elementDateYear.innerHTML = date.getFullYear();\n  };\n\n  var handleDayInput = function handleDayInput(event) {\n    var daysInMonth = new Date(value.getFullYear(), value.getMonth() + 1, 0).getDate();\n    var day = event.target.textContent.replace(/^0+/, '').replace(/[^\\d]/g, '').slice(0, 2);\n    if (Number(day) > daysInMonth) day = daysInMonth.toString();\n    event.target.textContent = day;\n    if (Number(day) < 1) day = '1';\n    value.setDate(Number(day));\n  };\n\n  var handleYearInput = function handleYearInput(event) {\n    var year = event.target.textContent.replace(/^0+/, '').replace(/[^\\d]/g, '').slice(0, 4);\n    event.target.textContent = year;\n    value.setFullYear(Number(year));\n  };\n\n  var handleBlur = function handleBlur(event) {\n    setValueHTML(value);\n  };\n\n  var updateMonth = function updateMonth(amount) {\n    var daysInNextMonth = new Date(value.getFullYear(), value.getMonth() + amount + 1, 0).getDate();\n    if (value.getDate() > daysInNextMonth) value.setDate(daysInNextMonth);\n    value.setMonth(value.getMonth() + amount);\n    setValueHTML(value);\n  };\n\n  var updateDay = function updateDay(amount) {\n    value.setDate(value.getDate() + amount);\n    setValueHTML(value);\n  };\n\n  var updateYear = function updateYear(amount) {\n    var nextYear = value.getFullYear() + amount;\n    if (nextYear < 0) value.setFullYear(0);else value.setFullYear(value.getFullYear() + amount);\n    setValueHTML(value);\n  };\n\n  var element = document.createElement('div');\n  var id = generateRandomId();\n  element.id = id;\n\n  var elementDateSelector = document.createElement('div');\n  elementDateSelector.classList.add(options.classes.backgroundInfo);\n\n  var elementDateSelectorInner = document.createElement('div');\n  elementDateSelectorInner.classList.add(options.classes.dateSelectorInner);\n\n  var elementDateUpMonth = document.createElement('div');\n  elementDateUpMonth.classList.add(options.classes.button);\n  elementDateUpMonth.classList.add(options.classes.elementThird);\n  elementDateUpMonth.classList.add(options.classes.dateSelectorUp);\n  elementDateUpMonth.innerHTML = arrow;\n\n  var elementDateUpDay = document.createElement('div');\n  elementDateUpDay.classList.add(options.classes.button);\n  elementDateUpDay.classList.add(options.classes.elementThird);\n  elementDateUpDay.classList.add(options.classes.dateSelectorUp);\n  elementDateUpDay.innerHTML = arrow;\n\n  var elementDateUpYear = document.createElement('div');\n  elementDateUpYear.classList.add(options.classes.button);\n  elementDateUpYear.classList.add(options.classes.elementThird);\n  elementDateUpYear.classList.add(options.classes.dateSelectorUp);\n  elementDateUpYear.innerHTML = arrow;\n\n  elementDateMonth.classList.add(options.classes.element);\n  elementDateMonth.classList.add(options.classes.elementThird);\n  elementDateMonth.innerHTML = options.dateMonths[value.getMonth()];\n\n  elementDateDay.classList.add(options.classes.element);\n  elementDateDay.classList.add(options.classes.elementThird);\n  elementDateDay.setAttribute('contentEditable', true);\n  elementDateDay.addEventListener('input', handleDayInput);\n  elementDateDay.addEventListener('blur', handleBlur);\n  elementDateDay.innerHTML = value.getDate();\n\n  elementDateYear.classList.add(options.classes.element);\n  elementDateYear.classList.add(options.classes.elementThird);\n  elementDateYear.setAttribute('contentEditable', true);\n  elementDateYear.addEventListener('input', handleYearInput);\n  elementDateYear.addEventListener('blur', handleBlur);\n  elementDateYear.innerHTML = value.getFullYear();\n\n  var elementDateDownMonth = document.createElement('div');\n  elementDateDownMonth.classList.add(options.classes.button);\n  elementDateDownMonth.classList.add(options.classes.elementThird);\n  elementDateDownMonth.innerHTML = arrow;\n\n  var elementDateDownDay = document.createElement('div');\n  elementDateDownDay.classList.add(options.classes.button);\n  elementDateDownDay.classList.add(options.classes.elementThird);\n  elementDateDownDay.innerHTML = arrow;\n\n  var elementDateDownYear = document.createElement('div');\n  elementDateDownYear.classList.add(options.classes.button);\n  elementDateDownYear.classList.add(options.classes.elementThird);\n  elementDateDownYear.innerHTML = arrow;\n\n  elementDateUpMonth.onclick = function () {\n    return updateMonth(1);\n  };\n  elementDateUpDay.onclick = function () {\n    return updateDay(1);\n  };\n  elementDateUpYear.onclick = function () {\n    return updateYear(1);\n  };\n  elementDateDownMonth.onclick = function () {\n    return updateMonth(-1);\n  };\n  elementDateDownDay.onclick = function () {\n    return updateDay(-1);\n  };\n  elementDateDownYear.onclick = function () {\n    return updateYear(-1);\n  };\n\n  var elementButtonLeft = document.createElement('div');\n  elementButtonLeft.classList.add(options.classes.button);\n  elementButtonLeft.classList.add(options.classes.elementHalf);\n  elementButtonLeft.classList.add(options.classes.backgroundSuccess);\n  elementButtonLeft.innerHTML = submitText;\n  elementButtonLeft.onclick = function () {\n    removeFromDocument(id, position);\n    removeOverlayFromDocument();\n    if (submitCallback) submitCallback(value);else if (submitCallbackArg) submitCallbackArg(value);\n  };\n\n  var elementButtonRight = document.createElement('div');\n  elementButtonRight.classList.add(options.classes.button);\n  elementButtonRight.classList.add(options.classes.elementHalf);\n  elementButtonRight.classList.add(options.classes.backgroundError);\n  elementButtonRight.innerHTML = cancelText;\n  elementButtonRight.onclick = function () {\n    removeFromDocument(id, position);\n    removeOverlayFromDocument();\n    if (cancelCallback) cancelCallback(value);else if (cancelCallbackArg) cancelCallbackArg(value);\n  };\n\n  elementDateSelectorInner.appendChild(elementDateUpMonth);\n  elementDateSelectorInner.appendChild(elementDateUpDay);\n  elementDateSelectorInner.appendChild(elementDateUpYear);\n  elementDateSelectorInner.appendChild(elementDateMonth);\n  elementDateSelectorInner.appendChild(elementDateDay);\n  elementDateSelectorInner.appendChild(elementDateYear);\n  elementDateSelectorInner.appendChild(elementDateDownMonth);\n  elementDateSelectorInner.appendChild(elementDateDownDay);\n  elementDateSelectorInner.appendChild(elementDateDownYear);\n  elementDateSelector.appendChild(elementDateSelectorInner);\n  element.appendChild(elementDateSelector);\n  element.appendChild(elementButtonLeft);\n  element.appendChild(elementButtonRight);\n\n  element.listener = function (event) {\n    if (enterClicked(event)) elementButtonLeft.click();else if (escapeClicked(event)) elementButtonRight.click();\n  };\n\n  addToDocument(element, position);\n\n  addOverlayToDocument(element, position);\n};\n\nexports.default = {\n  alert: alert,\n  force: force,\n  confirm: confirm,\n  input: input,\n  select: select,\n  date: date,\n  setOptions: setOptions,\n  hideAlerts: hideAlerts\n};\n\n/***/ })\n/******/ ]);\n});","\"use strict\";\n\nfunction makeShell() {\n    let that = document.getElementById(\"shell\");\n    \n    /**\n     * Common Python prompt.\n     */\n    that.ps1 = \">>> \";\n    \n    /**\n     * Common Python newline in block.\n     */\n    that.ps2 = \"... \";\n\n    /**\n     * Mimic CPython's REPL banner.\n     */\n    that.banner = function () {\n        return Basthon.banner().replace(\"on WebAssembly VM\", \"\");\n    };\n\n    /**\n     * A buffer to handle multiline shell input.\n     */\n    that.buffer = [];\n\n    /**\n     * Reset the multiline input buffer.\n     */\n    that.reset_buffer = function () {\n        that.buffer = [];\n    };\n\n    /**\n     * Initialize the shell.\n     */\n    that.init = async function () {\n        // just to be safe\n        that.reset_buffer();\n        \n        function interpreter(command) {\n            that.buffer.push(command);\n            const source = that.buffer.join('\\n');\n            if( Basthon.more(source) ) {\n                that.term.set_prompt(that.ps2);\n            } else {\n                that.term.set_prompt(that.ps1);\n                that.reset_buffer();\n                that.launch(source, true);\n            }\n        }\n\n        that.term = $('#shell').terminal(\n            interpreter,\n            {\n                greetings: that.banner(),\n                prompt: that.ps1,\n                completionEscape: false,\n                completion: function(command, callback) {\n                    callback(Basthon.complete(command)[0]);\n                },\n            }\n        );\n        // this prevents JQuery Terminal to redraw terminal and remove\n        // script wrapping feature\n        that.term.resize = () => {};\n\n\n        /* Event connections */\n        Basthon.addEventListener(\"eval.finished\", function (data) {\n            if( data.interactive && \"result\" in data ) {\n                that.echo(data.result[\"text/plain\"] + '\\n');\n            }\n            that.wakeup();\n        });\n\n        Basthon.addEventListener(\"eval.output\", function (data) {\n            switch(data.stream) {\n            case \"stdout\":\n                that.echo(data.content);\n                break;\n            case \"stderr\":\n                that.error(data.content);\n                break;\n            }\n        });\n\n        Basthon.addEventListener(\"eval.error\", function (data) {\n            that.wakeup();\n        });\n    };\n\n    /**\n     * Print a string in the shell.\n     */\n    that.echo = function (message) {\n        // JQuery.terminal adds a trailing newline that is not easy\n        // to remove with the current API. Doing our best here.\n\n        message = message.toString();\n\n        // prompt can be polluted with previous echo\n        // _prompt_tail is the line part just before the prompt\n        const term = that.term;\n        term._prompt_tail = term._prompt_tail || '';\n        let prompt = term.get_prompt();\n        if( prompt.startsWith(term._prompt_tail) )\n            prompt = prompt.slice(term._prompt_tail.length);\n        else\n            term._prompt_tail = '';\n        // here, prompt and _prompt_tail should be correctly isolated\n        const lines = message.split('\\n');\n        lines[0] = term._prompt_tail + lines[0];\n        term._prompt_tail = lines.pop();\n        term.set_prompt(term._prompt_tail + prompt);\n        if( lines.length )\n            term.echo(lines.join('\\n'));\n    };\n\n    /**\n     * Print error in shell (in red).\n     */\n    that.error = function (message) {\n        // JQuery.terminal adds a trailing newline that is not easy\n        // to remove with the current API. Doing our best here.\n        message = message.toString();\n        return that.term.error(message.replace(/\\n+$/, \"\"));\n    };\n\n    /**\n     * Pause the shell execution (usefull to wait for event or promise).\n     */\n    that.pause = function () {\n        that.term.pause();\n    };\n\n    /**\n     * Resume the shell execution (see `pause`).\n     */\n    that.wakeup = function () {\n        that.term.resume();\n    };\n\n    /**\n     * Recover the shell as it was at start.\n     */\n    that.clear = function () {\n        that.term.clear();\n        that.echo(that.banner() + \"\\n\");\n        that.reset_buffer();\n    };\n\n    /**\n     * Show script in shell with content as dropdown\n     * (should improve readability).\n     */\n    that.showScript = function (code) {\n        code = `# script executed\\n${code}`;\n        let script = `${that.ps1}`;\n        script += code.split('\\n').join(`\\n${that.ps2}`);\n        script += '\\n';\n        that.echo(script);\n        const output = that.querySelector(\".terminal-output\").lastChild;\n        const header = output.firstChild;\n        header.classList.add(\"exec-script-header\");\n        for( const e of header.children )\n            e.style.backgroundColor = \"inherit\";\n        function hideShow() {\n            const converter = {\"none\": \"block\", \"\": \"none\", \"block\": \"none\"};\n            for( const e of output.childNodes )\n                if( e !== header )\n                    e.style.display = converter[e.style.display];\n        }\n        header.addEventListener(\"click\", hideShow);\n        hideShow();\n    };\n\n    /**\n     * Launch code in shell.\n     */\n    that.launch = function (code, interactive=true) {\n        if( !interactive )\n            that.showScript(code);\n        that.pause();\n        Basthon.dispatchEvent(\"eval.request\", {code: code,\n                                               interactive: interactive});\n    };\n    \n    return that;\n}\n","\"use strict\";\n\nwindow.shell = makeShell();\nwindow.editor = makeEditor();\nwindow.graphics = makeGraphics();\nwindow.gui = makeGUI();\nwindow.gui.init();\n"]}